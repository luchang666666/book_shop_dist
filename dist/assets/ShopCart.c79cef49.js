var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a;import{_ as s}from"./NavBar.cc4d1581.js";import{p as c,B as u,i,s as d,q as h,C as p,T as m,r as g,o as b,e as f,f as k,w as v,F as C,k as _,z as y}from"./vendor.59df9684.js";import{g as x,m as j,c as O,d as w,s as P}from"./index.31d9e266.js";const S={components:{NavBar:s},setup(){const e=c({cart_list:[],result:[],checkall:!1});u();const s=i();d((()=>{x("include=goods").then((l=>{e.cart_list=l.data,e.result=l.data.filter((e=>1==e.is_checked)).map((e=>e.id))}))}));const g=h((()=>{let l=0;return e.cart_list.filter((l=>e.result.includes(l.id))).forEach((e=>{l+=parseInt(e.num)*parseFloat(e.goods.price)})),l}));return b=((e,l)=>{for(var t in l||(l={}))n.call(l,t)&&o(e,t,l[t]);if(a)for(var t of a(l))r.call(l,t)&&o(e,t,l[t]);return e})({},p(e)),l(b,t({onSubmit:()=>{0==e.result.length?m.fail("请先选择商品"):s.push({path:"/createorder"})},onChangeCount:(l,t)=>{j(t.name,{num:l}).then((a=>{console.log(a),e.cart_list.forEach((e=>{e.id==t.name&&(e.num=l)}))}))},groupChange:l=>{e.cart_list.length==l.length?e.checkall=!0:e.checkall=!1,e.result=l,O({cart_ids:l})},allCheck:()=>{e.checkall?(e.result=[],e.checkall=!1):(e.result=e.cart_list.map((e=>e.id)),e.checkall=!0)},deleteGood:l=>{w(l).then((l=>{x("include=goods").then((l=>{e.cart_list=l.data,e.result=l.data.filter((e=>1==e.is_checked)).map((e=>e.id)),P.dispatch("updateCart")}))}))},total:g}));var b}},B=y("购物车"),E={class:"cart-box"},G={class:"good-item"},V=k("br",null,null,-1),q=k("br",null,null,-1),F=k("br",null,null,-1),I=k("br",null,null,-1),N=k("br",null,null,-1),U=k("br",null,null,-1),z=y("全选");S.render=function(e,l,t,a,n,r){const o=g("nav-bar"),s=g("van-checkbox"),c=g("van-card"),u=g("van-stepper"),i=g("van-button"),d=g("van-swipe-cell"),h=g("van-checkbox-group"),p=g("van-submit-bar");return b(),f(C,null,[k(o,null,{default:v((()=>[B])),_:1}),k("div",E,[(b(!0),f(C,null,_(e.cart_list,(t=>(b(),f("div",{class:"cart-body",key:t.id},[k(h,{ref:"checkboxGroup",modelValue:e.result,"onUpdate:modelValue":l[1]||(l[1]=l=>e.result=l),onChange:a.groupChange},{default:v((()=>[k(d,{"right-width":50},{right:v((()=>[k(i,{square:"",type:"danger",style:{height:"100%"},text:"删除",onClick:e=>a.deleteGood(t.id)},null,8,["onClick"])])),default:v((()=>[k("div",G,[k(s,{name:t.id},null,8,["name"]),k(c,{class:"good-message",price:t.goods.price+".00",desc:t.goods.description,title:t.goods.title,thumb:t.goods.cover_url},null,8,["price","desc","title","thumb"]),k(u,{class:"stepper",integer:"",min:1,max:t.goods.stock,"model-value":t.num,name:t.id,"async-change":"",onChange:a.onChangeCount},null,8,["max","model-value","name","onChange"])])])),_:2},1024)])),_:2},1032,["modelValue","onChange"])])))),128)),V,q,F,I,N,U,k(p,{class:"submit-all",price:100*a.total,"button-text":"提交订单",onSubmit:a.onSubmit},{default:v((()=>[k(s,{onClick:a.allCheck,checked:e.checkall,"onUpdate:checked":l[2]||(l[2]=l=>e.checkall=l)},{default:v((()=>[z])),_:1},8,["onClick","checked"])])),_:1},8,["price","onSubmit"])])],64)};export default S;
