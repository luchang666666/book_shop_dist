var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,d=(r,s,t)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t;import{n,i as c,p as l,s as i,q as u,C as p,T as m,r as b,o as f,e as v,f as h,w as g,F as y,k as w,z as j}from"./vendor.59df9684.js";import{s as O}from"./index.31d9e266.js";import{_}from"./NavBar.cc4d1581.js";import{g as P,c as L,p as S}from"./order.564af5c1.js";const x={components:{NavBar:_},setup(){const e=n(!1),b=c(),f=l({cartList:[],address:{},orderdetail:{}});i((()=>{P().then((e=>{f.cartList=e.carts,e.address.forEach((e=>{1==e.is_default&&(f.address=e)})),console.log(e)}))}));const v=u((()=>{let e=0;return f.cartList.forEach((r=>{e+=parseInt(r.num)*parseFloat(r.goods.price)})),e}));return h=((e,r)=>{for(var s in r||(r={}))a.call(r,s)&&d(e,s,r[s]);if(t)for(var s of t(r))o.call(r,s)&&d(e,s,r[s]);return e})({},p(f)),r(h,s({total:v,onSubmit:r=>{console.log(r),L({address_id:r}).then((r=>{console.log(r),r&&(console.log(r),m.success("提交成功"),O.dispatch("updateCart"),S(r.id,{type:"aliyun"}).then((r=>{console.log(r),"10000"===r.code&&(f.orderdetail=r,e.value=!0,setTimeout((()=>{m.success("支付成功"),e.value=!1,b.push({path:"/order"})}),5e3))})))}))},show:e}));var h}},E=j("提交订单"),k={class:"submit"},q={class:"wrapper"};x.render=function(e,r,s,t,a,o){const d=b("nav-bar"),n=b("van-contact-card"),c=b("van-card"),l=b("van-submit-bar"),i=b("van-overlay");return f(),v(y,null,[h(d,null,{default:g((()=>[E])),_:1}),h(n,{type:"edit",name:e.address.name+"    电话: "+e.address.phone,tel:e.address.province+e.address.city+e.address.county+e.address.address,editable:!1},null,8,["name","tel"]),(f(!0),v(y,null,w(e.cartList,(e=>(f(),v(c,{key:e.id,num:e.num,price:e.goods.price+".00",desc:e.created_at,title:e.goods.title,thumb:e.goods.cover_url},null,8,["num","price","desc","title","thumb"])))),128)),h("div",k,[h(l,{price:100*t.total,"button-text":"提交订单",onSubmit:r[1]||(r[1]=r=>t.onSubmit(e.address.id))},null,8,["price"])]),h(i,{show:t.show},{default:g((()=>[h("div",q,[h("img",{width:"200",height:"200",src:e.orderdetail.qr_code_url,alt:""},null,8,["src"])])])),_:1},8,["show"])],64)};export default x;
